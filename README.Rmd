---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "80%"
)
```

# bayeslinear

<!-- badges: start -->
<!-- badges: end -->

<tt>bayeslinear</tt> provides tools to perform a Bayes Linear analysis as well as generalising the solution space to convex subsets. For overview of these methodologies see HERE.

## Installation

<tt>bayeslinear</tt> is currently in development; install the latest version from [GitHub](https://github.com/) with:

``` r
install.packages("devtools")
devtools::install_github("astfalckl/bayeslinear")
```

Also, call in some other packages we need for the README
```{r, warning = FALSE, message = FALSE}
library(bayeslinear)
library(ggplot2)
library(CVXR)
library(dplyr)
library(patchwork)

theme_set(theme_bw())
```

# Standard and Generalised Bayes Linear Analysis

We demonstrate the code by repeating the example given in PAPER.

## Creating Belief Structures

A belief structure is the fundamental unit of information that specifies the geometry of a Bayes linear analysis. We are required to specify $\mathbb{E}(X)$, $\mathbb{E}(D)$, $\mathrm{var}(X)$, $\mathrm{var}(D)$ and $\mathrm{cov}(X,D)$. The methods in <tt>bayeslinear</tt> are based on the creation of a belief structure object through the function <tt>belief_structure()</tt>.

```{r}
nx <- 2
nd <- 2

exp_x <- matrix(c(1, 1))
exp_d <- matrix(c(1, 1))
var_x <- matrix(c(0.54, 0.09, 0.09, 0.54), nrow = nx)
cov_xd <- matrix(c(0.4, -0.1, -.1, -.3), nrow = nx)
var_d <- matrix(c(1, -0.2, -0.2, 1), nrow = nd)

bivariate_bs <- belief_structure(exp_x, exp_d, cov_xd, var_x, var_d)
bivariate_bs
```

## Adjusting Belief Structures

A <tt>belief_structure</tt> object is adjusted by some data <tt>d</tt> via the <tt>adjust</tt> method. An adjusted belief structure <tt>adj_belief_structure</tt> is returned. Note that the initial belief structure is always stored in <tt>prior_bs</tt>.

```{r}
d <- c(3, 6.5)
bivariate_adj_bs <- adjust(bivariate_bs, d)
bivariate_adj_bs
```

## Creating Generalised Belief Structures

We may augment a belief structure with a solution constraint by using the <tt>gen_belief_structure</tt> method. This is similar to above however with the inclusion of a quoted constraint that gets passed to <tt>CVXR</tt>. We demonstrate what some of these constraints look like here, and point towards [here](https://cvxr.rbind.io) for a comprehensive list of examples.

```{r}
bivariate_gbs <- gen_belief_structure(
  exp_x, exp_d, cov_xd, var_x, var_d,
  quote(list(gen_adj_exp >= 0))
)
bivariate_gbs
```

## Adjusting Generalised Belief Structures

This happens with the same <tt>adjust</tt> method as before, but returns the generalised adjusted expectation and variance according to the specified constraint.

```{r}
bivariate_adj_gbs <- adjust(bivariate_gbs, d)
bivariate_adj_gbs
```
